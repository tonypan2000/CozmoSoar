# operator match-existing-object
# Tries to match the new object against those already in the world
# Returns a match as ^matches-existing-object <obj-info> or none
sp {insert-object-into-world*propose*match-existing-object
   (state <s> ^name insert-object-into-world
              ^source-obj <source>
              ^source-type <type>
             -^matches-existing-object <any>)
-->
   (<s> ^operator <o> +)
   (<o> ^name match-existing-object
        ^source-obj <source>
        ^source-type <type>)
}

# Copy the result onto the state
sp {insert-object-into-world*apply*match-existing-object*mark*matches-existing-object
   (state <s> ^name insert-object-into-world
              ^operator <o>)
   (<o> ^name match-existing-object
        ^matches <res>)
-->
   (<s> ^matches-existing-object <res>)
}

